# テーブルを定義できる

テーブル定義では各テーブルに対して、テーブル名、カラム名、データ型、NULL(NULL OK の場合のみ YES と記載)、

キー（キーが存在する場合、PRIMARY/INDEX のどちらかを記載）、初期値（ある場合のみ記載）、

AUTO INCREMENT（ある場合のみ YES と記載）、外部キー制約、ユニークキー制約を定義します。

## データ型

データ型とは、データベースに格納されるデータの種類や性質を示すものです。

データベースにはさまざまな種類の情報を保存することができますが、

そのデータがどのような形式であるかを指定することで、データの整合性を保つことができます。

また、データ型を指定することで、データベースがどのような操作を行うべきかを理解し、効率的にデータを処理できるようになります。

一般的なデータ型には以下のようなものがあります。

整数型（INT）: 整数値を表すデータ型です。例: 0, -5, 42 など。

小数型（FLOAT, DOUBLE, DECIMAL）: 小数値を表すデータ型です。例: 0.5, -3.14, 2.718 など。

文字列型（CHAR, VARCHAR, TEXT）: 文字列を表すデータ型です。例: "こんにちは", "apple", "123" など。

日付型（DATE, DATETIME, TIMESTAMP）: 日付や時刻を表すデータ型です。例: "2023-05-07", "12:34:56" など。

ブール型（BOOLEAN）: 真（true）または偽（false）の 2 つの値を表すデータ型です。

データベース初心者にとって理解しやすくするために、

データ型はデータがどのような形式で保存されるかを示すカテゴリのようなものだと考えてください。

データ型を適切に選択することで、データの整合性や効率的なデータ処理が可能になります。

---

## NULL

NULL とは、データベースにおいて「値が存在しない」または「未知の値」を表す特殊な値です。

NULL は、空白やゼロとは異なります。例えば、データベースに顧客情報を保存する場合、顧客の電話番号が未登録の場合、

電話番号の欄に NULL が入ります。これは、電話番号が 0 だという意味ではなく、単に電話番号が存在しない、

またはまだ分からないという状態を示しています。

データベース初心者にとって理解しやすくするために、

**NULL は「情報が欠けている」または「まだ入手できていない」データを表すものだと考えてください。**

データベース内で NULL を許容するかどうかは、テーブル定義時に決定されます。NULL を許容しないカラムには

必ず値が存在する必要があります。逆に、NULL を許容するカラムは、値が存在しない場合も許可されます。

---

## プライマリーキー

プライマリーキーとは、データベースのテーブル内で各行（レコード）を一意（ユニーク）に識別するために使用されるカラム（またはカラムの組み合わせ）です。

プライマリーキーが割り当てられたカラムには、重複する値が存在してはいけませんし、NULL 値も許可されません。

データベース初心者にわかりやすく説明するために、プライマリーキーは各行を特定できる「固有の識別コード」のようなものだと考えてください。

例えば、学生の成績を管理するデータベースでは、学籍番号がプライマリーキーとして使用されることがあります。

学籍番号は、各学生に一意の番号が割り当てられるため、他の学生と混同することなく、特定の学生の成績情報を取得することができます。

プライマリーキーを設定することで、データの整合性が保たれ、検索や更新などの操作が効率的に行われます。

また、プライマリーキーは、他のテーブルと関連付ける際に外部キーとして使用されることがあり、データベースの構造を整理しやすくします。

プライマリーキーは別名、主キーともいいます。

---

## 初期値

初期値（デフォルト値）とは、データベースのテーブル定義において、特定のカラムに対して、新しい行（レコード）が追加される際に、

そのカラムに自動的に設定される値のことです。デフォルト値は、

新しいレコードを追加する際にそのカラムに値が明示的に指定されなかった場合に適用されます。

データベース初心者にわかりやすく説明するために、デフォルト値は「もし何も指定されなければ自動的に入る値」のようなものだと考えてください。

例えば、オンラインショップの注文履歴テーブルで、注文ステータスカラムにデフォルト値として「新規注文」を設定しておくことができます。

これにより、新しい注文が追加されたときに、注文ステータスが明示的に指定されなくても、自動的に「新規注文」として登録されることになります。

デフォルト値を適切に設定することで、データの入力漏れや誤入力を防ぐことができ、データの整合性を保つことができます。

また、データ入力の手間も軽減されるため、効率的なデータ管理が可能になります。

---

## AUTO INCREMENT

AUTO INCREMENT（自動増分）とは、データベースのテーブル定義において、

特定のカラム（通常はプライマリーキー）に対して、新しい行（レコード）が追加される際に、そのカラムの値が自動的に増加する機能です。

AUTO INCREMENT が設定されたカラムは、通常、整数型（INT）で定義されます。

データベース初心者にわかりやすく説明するために、AUTO INCREMENT は「自動的に連番が振られる機能」のようなものだと考えてください。

例えば、オンラインショップの注文履歴テーブルで、注文 ID カラムに AUTO INCREMENT を設定しておくことができます。

これにより、新しい注文が追加されるたびに、注文 ID が自動的に連番で振られ、各注文が一意に識別できるようになります。

AUTO INCREMENT を設定することで、ユニークな識別子の生成が自動化され、データの整合性が保たれます。

また、重複する ID の誤入力や、ID の設定漏れを防ぐことができ、効率的なデータ管理が可能になります。

ただし、**AUTO INCREMENT が設定されたカラムは、同じテーブル内で 1 つまでしか設定できません。**

大体プライマリーキーが AUTO INCREMENT となります。

---

## 外部キー制約

外部キー制約とは、データベースのテーブル間で関連付けを行うために使用される制約のことです。

外部キーは、あるテーブルのカラムが、別のテーブルのプライマリーキーを参照することで、テーブル間の関連性を表現します。

外部キー制約を設定することで、関連するテーブル間でデータの整合性を保つことができます。

データベース初心者にわかりやすく説明するために、外部キー制約は「テーブル間の関係を保つためのルール」のようなものだと考えてください

例えば、オンラインショップのデータベースでは、注文履歴テーブルと顧客情報テーブルがあります。

注文履歴テーブルには、どの顧客がどの商品を注文したかを記録するために、

顧客情報テーブルのプライマリーキー（例えば、顧客 ID）を参照する外部キー（例えば、注文者 ID）が存在します。

外部キー制約を設定することで、以下のようなデータの整合性を保つことができます。

存在しない顧客 ID を参照する注文履歴レコードが作成されることを防ぐ。

既に注文履歴テーブルで参照されている顧客 ID を持つ顧客情報レコードを削除することを防ぐ。

このように、外部キー制約を使用することで、テーブル間の関係を整理し、データの整合性を保つことができます。

---

## ユニークキー制約

ユニークキー制約とは、データベースのテーブル内で特定のカラム（またはカラムの組み合わせ）の値が一意（ユニーク）であることを保証する

制約のことです。ユニークキー制約が設定されたカラムには、重複する値が存在してはいけません。

ただし、ユニークキー制約が設定されたカラムでは、NULL 値が許可されることがあります（これはプライマリーキーとの違いの一つです）。

データベース初心者にわかりやすく説明するために、

**ユニークキー制約は「重複しない値を保証するルール」のようなものだと考えてください**

例えば、**ユーザーアカウント情報を管理するテーブルでは、メールアドレスカラムにユニークキー制約を設定しておくことができます。**

これにより、同じメールアドレスを持つ複数のユーザーアカウントが作成されることを防ぐことができます。

ユニークキー制約を設定することで、データの整合性が保たれ、重複データや誤入力を防ぐことができます。

また、ユニークキー制約が設定されたカラムは、検索や結合などの操作が効率的に行われるため、データ管理が容易になります。

## テーブル定義

EC サイトの ER 図を、テーブル定義しましょう。

各テーブルのテーブル名、カラム名、データ型、NULL(NULL OK の場合のみ YES と記載)、キー（キーが存在する場合、PRIMARY/INDEX のどちらか

を記載）、初期値（ある場合のみ記載）、AUTO INCREMENT（ある場合のみ YES と記載）、外部キー制約、ユニークキー制約を設定してください。

---

**ユーザーテーブル**

| カラム名 | データ型     | NULL | キー    | 初期値 | AUTO INCREMENT | 外部キー制約 | ユニークキー制約 |
| -------- | ------------ | ---- | ------- | ------ | -------------- | ------------ | ---------------- |
| ID       | bigint(20)   | NO   | PRIMARY |        | YES            |              |
| 名前     | varchar(100) | NO   |         |        |                |              |

---

注文テーブル
カラム名 | データ型 | NULL | キー | 初期値 | AUTO INCREMENT | 外部キー制約 | ユニークキー制約
-------------|--------------|------|---------|------|--------------|-----------|-------------
ID | bigint(20) | NO | PRIMARY | | YES | |
user_ID | bigint(20) | NO | FOREIGN | | | ユーザー |
order_date | datetime | NO | | | | |

---

注文商品テーブル
カラム名 | データ型 | NULL | キー | 初期値 | AUTO INCREMENT | 外部キー制約 | ユニークキー制約
-------------|--------------|------|---------|------|--------------|------------|-------------
ID | bigint(20) | NO | PRIMARY | | YES | |
item_ID | bigint(20) | NO | FOREIGN | | | 商品 |
order_ID | bigint(20) | NO | FOREIGN | | | 注文 |
quantity | int(11) | NO | | | | |

---

商品テーブル
カラム名 | データ型 | NULL | キー | 初期値 | AUTO INCREMENT | 外部キー制約 | ユニークキー制約
-------------|--------------|------|---------|------|--------------|-----------|-------------
ID | bigint(20) | NO | PRIMARY | | YES | |
name | varchar(255) | NO | | | | |
price | int(11) | NO | | | | |
category_ID | bigint(20) | NO | FOREIGN | | | カテゴリー |

---

カテゴリーテーブル
カラム名 | データ型 | NULL | キー | 初期値 | AUTO INCREMENT | 外部キー制約 | ユニークキー制約
-------------|--------------|------|---------|------|--------------|-----------|-------------
ID | bigint(20) | NO | PRIMARY | | YES | |
category_name| varchar(255) | NO | | | | |
